(function(){"use strict";var Oe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xe(S){return S&&S.__esModule&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S}var be={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(S,y){((K,_)=>{S.exports=_()})(Oe,function K(){var _=typeof self<"u"?self:typeof window<"u"?window:_!==void 0?_:{},ee,O=!_.document&&!!_.postMessage,ie=_.IS_PAPA_WORKER||!1,se={},G=0,o={};function W(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var i=ye(t);i.chunkSize=parseInt(i.chunkSize),t.step||t.chunk||(i.chunkSize=null),this._handle=new Ee(i),(this._handle.streamer=this)._config=i}).call(this,e),this.parseChunk=function(t,i){var n=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<n){let d=this._config.newline;d||(r=this._config.quoteChar||'"',d=this._handle.guessLineEndings(t,r)),t=[...t.split(d).slice(n)].join(d)}this.isFirstChunk&&b(this._config.beforeFirstChunk)&&(r=this._config.beforeFirstChunk(t))!==void 0&&(t=r),this.isFirstChunk=!1,this._halted=!1;var n=this._partialLine+t,r=(this._partialLine="",this._handle.parse(n,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=r.meta.cursor,n=(this._finished||(this._partialLine=n.substring(t-this._baseIndex),this._baseIndex=t),r&&r.data&&(this._rowCount+=r.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),ie)_.postMessage({results:r,workerId:o.WORKER_ID,finished:n});else if(b(this._config.chunk)&&!i){if(this._config.chunk(r,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=r=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(r.data),this._completeResults.errors=this._completeResults.errors.concat(r.errors),this._completeResults.meta=r.meta),this._completed||!n||!b(this._config.complete)||r&&r.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),n||r&&r.meta.paused||this._nextChunk(),r}this._halted=!0},this._sendError=function(t){b(this._config.error)?this._config.error(t):ie&&this._config.error&&_.postMessage({workerId:o.WORKER_ID,error:t,finished:!1})}}function H(e){var t;(e=e||{}).chunkSize||(e.chunkSize=o.RemoteChunkSize),W.call(this,e),this._nextChunk=O?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(i){this._input=i,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),O||(t.onload=re(this._chunkLoaded,this),t.onerror=re(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!O),this._config.downloadRequestHeaders){var i,n=this._config.downloadRequestHeaders;for(i in n)t.setRequestHeader(i,n[i])}var r;this._config.chunkSize&&(r=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+r));try{t.send(this._config.downloadRequestBody)}catch(d){this._chunkError(d.message)}O&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(i=>(i=i.getResponseHeader("Content-Range"))!==null?parseInt(i.substring(i.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(i){i=t.statusText||i,this._sendError(new Error(i))}}function P(e){(e=e||{}).chunkSize||(e.chunkSize=o.LocalChunkSize),W.call(this,e);var t,i,n=typeof FileReader<"u";this.stream=function(r){this._input=r,i=r.slice||r.webkitSlice||r.mozSlice,n?((t=new FileReader).onload=re(this._chunkLoaded,this),t.onerror=re(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var r=this._input,d=(this._config.chunkSize&&(d=Math.min(this._start+this._config.chunkSize,this._input.size),r=i.call(r,this._start,d)),t.readAsText(r,this._config.encoding));n||this._chunkLoaded({target:{result:d}})},this._chunkLoaded=function(r){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(r.target.result)},this._chunkError=function(){this._sendError(t.error)}}function J(e){var t;W.call(this,e=e||{}),this.stream=function(i){return t=i,this._nextChunk()},this._nextChunk=function(){var i,n;if(!this._finished)return i=this._config.chunkSize,t=i?(n=t.substring(0,i),t.substring(i)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function ce(e){W.call(this,e=e||{});var t=[],i=!0,n=!1;this.pause=function(){W.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){W.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(r){this._input=r,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=re(function(r){try{t.push(typeof r=="string"?r:r.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(d){this._streamError(d)}},this),this._streamError=re(function(r){this._streamCleanUp(),this._sendError(r)},this),this._streamEnd=re(function(){this._streamCleanUp(),n=!0,this._streamData("")},this),this._streamCleanUp=re(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Ee(e){var t,i,n,r,d=Math.pow(2,53),T=-d,z=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,U=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,f=this,w=0,a=0,L=!1,l=!1,c=[],s={data:[],errors:[],meta:{}};function I(p){return e.skipEmptyLines==="greedy"?p.join("").trim()==="":p.length===1&&p[0].length===0}function x(){if(s&&n&&(N("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines&&(s.data=s.data.filter(function(u){return!I(u)})),D()){let u=function(C,A){b(e.transformHeader)&&(C=e.transformHeader(C,A)),c.push(C)};if(s)if(Array.isArray(s.data[0])){for(var p=0;D()&&p<s.data.length;p++)s.data[p].forEach(u);s.data.splice(0,1)}else s.data.forEach(u)}function m(u,C){for(var A=e.header?{}:[],k=0;k<u.length;k++){var v=k,g=u[k],g=((Q,h)=>(E=>(e.dynamicTypingFunction&&e.dynamicTyping[E]===void 0&&(e.dynamicTyping[E]=e.dynamicTypingFunction(E)),(e.dynamicTyping[E]||e.dynamicTyping)===!0))(Q)?h==="true"||h==="TRUE"||h!=="false"&&h!=="FALSE"&&((E=>{if(z.test(E)&&(E=parseFloat(E),T<E&&E<d))return 1})(h)?parseFloat(h):U.test(h)?new Date(h):h===""?null:h):h)(v=e.header?k>=c.length?"__parsed_extra":c[k]:v,g=e.transform?e.transform(g,v):g);v==="__parsed_extra"?(A[v]=A[v]||[],A[v].push(g)):A[v]=g}return e.header&&(k>c.length?N("FieldMismatch","TooManyFields","Too many fields: expected "+c.length+" fields but parsed "+k,a+C):k<c.length&&N("FieldMismatch","TooFewFields","Too few fields: expected "+c.length+" fields but parsed "+k,a+C)),A}var R;s&&(e.header||e.dynamicTyping||e.transform)&&(R=1,!s.data.length||Array.isArray(s.data[0])?(s.data=s.data.map(m),R=s.data.length):s.data=m(s.data,0),e.header&&s.meta&&(s.meta.fields=c),a+=R)}function D(){return e.header&&c.length===0}function N(p,m,R,u){p={type:p,code:m,message:R},u!==void 0&&(p.row=u),s.errors.push(p)}b(e.step)&&(r=e.step,e.step=function(p){s=p,D()?x():(x(),s.data.length!==0&&(w+=p.data.length,e.preview&&w>e.preview?i.abort():(s.data=s.data[0],r(s,f))))}),this.parse=function(p,m,R){var u=e.quoteChar||'"',u=(e.newline||(e.newline=this.guessLineEndings(p,u)),n=!1,e.delimiter?b(e.delimiter)&&(e.delimiter=e.delimiter(p),s.meta.delimiter=e.delimiter):((u=((C,A,k,v,g)=>{var Q,h,E,ne;g=g||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var oe=0;oe<g.length;oe++){for(var V,de=g[oe],F=0,Z=0,$=0,M=(E=void 0,new me({comments:v,delimiter:de,newline:A,preview:10}).parse(C)),te=0;te<M.data.length;te++)k&&I(M.data[te])?$++:(V=M.data[te].length,Z+=V,E===void 0?E=V:0<V&&(F+=Math.abs(V-E),E=V));0<M.data.length&&(Z/=M.data.length-$),(h===void 0||F<=h)&&(ne===void 0||ne<Z)&&1.99<Z&&(h=F,Q=de,ne=Z)}return{successful:!!(e.delimiter=Q),bestDelimiter:Q}})(p,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=u.bestDelimiter:(n=!0,e.delimiter=o.DefaultDelimiter),s.meta.delimiter=e.delimiter),ye(e));return e.preview&&e.header&&u.preview++,t=p,i=new me(u),s=i.parse(t,m,R),x(),L?{meta:{paused:!0}}:s||{meta:{paused:!1}}},this.paused=function(){return L},this.pause=function(){L=!0,i.abort(),t=b(e.chunk)?"":t.substring(i.getCharIndex())},this.resume=function(){f.streamer._halted?(L=!1,f.streamer.parseChunk(t,!0)):setTimeout(f.resume,3)},this.aborted=function(){return l},this.abort=function(){l=!0,i.abort(),s.meta.aborted=!0,b(e.complete)&&e.complete(s),t=""},this.guessLineEndings=function(C,u){C=C.substring(0,1048576);var u=new RegExp(he(u)+"([^]*?)"+he(u),"gm"),R=(C=C.replace(u,"")).split("\r"),u=C.split(`
`),C=1<u.length&&u[0].length<R[0].length;if(R.length===1||C)return`
`;for(var A=0,k=0;k<R.length;k++)R[k][0]===`
`&&A++;return A>=R.length/2?`\r
`:"\r"}}function he(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function me(e){var t=(e=e||{}).delimiter,i=e.newline,n=e.comments,r=e.step,d=e.preview,T=e.fastMode,z=null,U=!1,f=e.quoteChar==null?'"':e.quoteChar,w=f;if(e.escapeChar!==void 0&&(w=e.escapeChar),(typeof t!="string"||-1<o.BAD_DELIMITERS.indexOf(t))&&(t=","),n===t)throw new Error("Comment character same as delimiter");n===!0?n="#":(typeof n!="string"||-1<o.BAD_DELIMITERS.indexOf(n))&&(n=!1),i!==`
`&&i!=="\r"&&i!==`\r
`&&(i=`
`);var a=0,L=!1;this.parse=function(l,c,s){if(typeof l!="string")throw new Error("Input must be a string");var I=l.length,x=t.length,D=i.length,N=n.length,p=b(r),m=[],R=[],u=[],C=a=0;if(!l)return F();if(T||T!==!1&&l.indexOf(f)===-1){for(var A=l.split(i),k=0;k<A.length;k++){if(u=A[k],a+=u.length,k!==A.length-1)a+=i.length;else if(s)return F();if(!n||u.substring(0,N)!==n){if(p){if(m=[],ne(u.split(t)),Z(),L)return F()}else ne(u.split(t));if(d&&d<=k)return m=m.slice(0,d),F(!0)}}return F()}for(var v=l.indexOf(t,a),g=l.indexOf(i,a),Q=new RegExp(he(w)+he(f),"g"),h=l.indexOf(f,a);;)if(l[a]===f)for(h=a,a++;;){if((h=l.indexOf(f,h+1))===-1)return s||R.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:m.length,index:a}),V();if(h===I-1)return V(l.substring(a,h).replace(Q,f));if(f===w&&l[h+1]===w)h++;else if(f===w||h===0||l[h-1]!==w){v!==-1&&v<h+1&&(v=l.indexOf(t,h+1));var E=oe((g=g!==-1&&g<h+1?l.indexOf(i,h+1):g)===-1?v:Math.min(v,g));if(l.substr(h+1+E,x)===t){u.push(l.substring(a,h).replace(Q,f)),l[a=h+1+E+x]!==f&&(h=l.indexOf(f,a)),v=l.indexOf(t,a),g=l.indexOf(i,a);break}if(E=oe(g),l.substring(h+1+E,h+1+E+D)===i){if(u.push(l.substring(a,h).replace(Q,f)),de(h+1+E+D),v=l.indexOf(t,a),h=l.indexOf(f,a),p&&(Z(),L))return F();if(d&&m.length>=d)return F(!0);break}R.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:m.length,index:a}),h++}}else if(n&&u.length===0&&l.substring(a,a+N)===n){if(g===-1)return F();a=g+D,g=l.indexOf(i,a),v=l.indexOf(t,a)}else if(v!==-1&&(v<g||g===-1))u.push(l.substring(a,v)),a=v+x,v=l.indexOf(t,a);else{if(g===-1)break;if(u.push(l.substring(a,g)),de(g+D),p&&(Z(),L))return F();if(d&&m.length>=d)return F(!0)}return V();function ne($){m.push($),C=a}function oe($){var M=0;return M=$!==-1&&($=l.substring(h+1,$))&&$.trim()===""?$.length:M}function V($){return s||($===void 0&&($=l.substring(a)),u.push($),a=I,ne(u),p&&Z()),F()}function de($){a=$,ne(u),u=[],g=l.indexOf(i,a)}function F($){if(e.header&&!c&&m.length&&!U){var M=m[0],te=Object.create(null),ke=new Set(M);let Ce=!1;for(let ae=0;ae<M.length;ae++){let Y=M[ae];if(te[Y=b(e.transformHeader)?e.transformHeader(Y,ae):Y]){let fe,Se=te[Y];for(;fe=Y+"_"+Se,Se++,ke.has(fe););ke.add(fe),M[ae]=fe,te[Y]++,Ce=!0,(z=z===null?{}:z)[fe]=Y}else te[Y]=1,M[ae]=Y;ke.add(Y)}Ce&&console.warn("Duplicate headers found and renamed."),U=!0}return{data:m,errors:R,meta:{delimiter:t,linebreak:i,aborted:L,truncated:!!$,cursor:C+(c||0),renamedHeaders:z}}}function Z(){r(F()),m=[],R=[]}},this.abort=function(){L=!0},this.getCharIndex=function(){return a}}function je(e){var t=e.data,i=se[t.workerId],n=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var r={abort:function(){n=!0,we(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Re,resume:Re};if(b(i.userStep)){for(var d=0;d<t.results.data.length&&(i.userStep({data:t.results.data[d],errors:t.results.errors,meta:t.results.meta},r),!n);d++);delete t.results}else b(i.userChunk)&&(i.userChunk(t.results,r,t.file),delete t.results)}t.finished&&!n&&we(t.workerId,t.results)}function we(e,t){var i=se[e];b(i.userComplete)&&i.userComplete(t),i.terminate(),delete se[e]}function Re(){throw new Error("Not implemented.")}function ye(e){if(typeof e!="object"||e===null)return e;var t,i=Array.isArray(e)?[]:{};for(t in e)i[t]=ye(e[t]);return i}function re(e,t){return function(){e.apply(t,arguments)}}function b(e){return typeof e=="function"}return o.parse=function(e,t){var i=(t=t||{}).dynamicTyping||!1;if(b(i)&&(t.dynamicTypingFunction=i,i={}),t.dynamicTyping=i,t.transform=!!b(t.transform)&&t.transform,!t.worker||!o.WORKERS_SUPPORTED)return i=null,o.NODE_STREAM_INPUT,typeof e=="string"?(e=(n=>n.charCodeAt(0)!==65279?n:n.slice(1))(e),i=new(t.download?H:J)(t)):e.readable===!0&&b(e.read)&&b(e.on)?i=new ce(t):(_.File&&e instanceof File||e instanceof Object)&&(i=new P(t)),i.stream(e);(i=(()=>{var n;return!!o.WORKERS_SUPPORTED&&(n=(()=>{var r=_.URL||_.webkitURL||null,d=K.toString();return o.BLOB_URL||(o.BLOB_URL=r.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",d,")();"],{type:"text/javascript"})))})(),(n=new _.Worker(n)).onmessage=je,n.id=G++,se[n.id]=n)})()).userStep=t.step,i.userChunk=t.chunk,i.userComplete=t.complete,i.userError=t.error,t.step=b(t.step),t.chunk=b(t.chunk),t.complete=b(t.complete),t.error=b(t.error),delete t.worker,i.postMessage({input:e,config:t,workerId:i.id})},o.unparse=function(e,t){var i=!1,n=!0,r=",",d=`\r
`,T='"',z=T+T,U=!1,f=null,w=!1,a=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||o.BAD_DELIMITERS.filter(function(c){return t.delimiter.indexOf(c)!==-1}).length||(r=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(i=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(U=t.skipEmptyLines),typeof t.newline=="string"&&(d=t.newline),typeof t.quoteChar=="string"&&(T=t.quoteChar),typeof t.header=="boolean"&&(n=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");f=t.columns}t.escapeChar!==void 0&&(z=t.escapeChar+T),t.escapeFormulae instanceof RegExp?w=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(w=/^[=+\-@\t\r].*$/)}})(),new RegExp(he(T),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return L(null,e,U);if(typeof e[0]=="object")return L(f||Object.keys(e[0]),e,U)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||f),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),L(e.fields||[],e.data||[],U);throw new Error("Unable to serialize unrecognized input");function L(c,s,I){var x="",D=(typeof c=="string"&&(c=JSON.parse(c)),typeof s=="string"&&(s=JSON.parse(s)),Array.isArray(c)&&0<c.length),N=!Array.isArray(s[0]);if(D&&n){for(var p=0;p<c.length;p++)0<p&&(x+=r),x+=l(c[p],p);0<s.length&&(x+=d)}for(var m=0;m<s.length;m++){var R=(D?c:s[m]).length,u=!1,C=D?Object.keys(s[m]).length===0:s[m].length===0;if(I&&!D&&(u=I==="greedy"?s[m].join("").trim()==="":s[m].length===1&&s[m][0].length===0),I==="greedy"&&D){for(var A=[],k=0;k<R;k++){var v=N?c[k]:k;A.push(s[m][v])}u=A.join("").trim()===""}if(!u){for(var g=0;g<R;g++){0<g&&!C&&(x+=r);var Q=D&&N?c[g]:g;x+=l(s[m][Q],g)}m<s.length-1&&(!I||0<R&&!C)&&(x+=d)}}return x}function l(c,s){var I,x;return c==null?"":c.constructor===Date?JSON.stringify(c).slice(1,25):(x=!1,w&&typeof c=="string"&&w.test(c)&&(c="'"+c,x=!0),I=c.toString().replace(a,z),(x=x||i===!0||typeof i=="function"&&i(c,s)||Array.isArray(i)&&i[s]||((D,N)=>{for(var p=0;p<N.length;p++)if(-1<D.indexOf(N[p]))return!0;return!1})(I,o.BAD_DELIMITERS)||-1<I.indexOf(r)||I.charAt(0)===" "||I.charAt(I.length-1)===" ")?T+I+T:I)}},o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!O&&!!_.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=me,o.ParserHandle=Ee,o.NetworkStreamer=H,o.FileStreamer=P,o.StringStreamer=J,o.ReadableStreamStreamer=ce,_.jQuery&&((ee=_.jQuery).fn.parse=function(e){var t=e.config||{},i=[];return this.each(function(d){if(!(ee(this).prop("tagName").toUpperCase()==="INPUT"&&ee(this).attr("type").toLowerCase()==="file"&&_.FileReader)||!this.files||this.files.length===0)return!0;for(var T=0;T<this.files.length;T++)i.push({file:this.files[T],inputElem:this,instanceConfig:ee.extend({},t)})}),n(),this;function n(){if(i.length===0)b(e.complete)&&e.complete();else{var d,T,z,U,f=i[0];if(b(e.before)){var w=e.before(f.file,f.inputElem);if(typeof w=="object"){if(w.action==="abort")return d="AbortError",T=f.file,z=f.inputElem,U=w.reason,void(b(e.error)&&e.error({name:d},T,z,U));if(w.action==="skip")return void r();typeof w.config=="object"&&(f.instanceConfig=ee.extend(f.instanceConfig,w.config))}else if(w==="skip")return void r()}var a=f.instanceConfig.complete;f.instanceConfig.complete=function(L){b(a)&&a(L,f.file,f.inputElem),r()},o.parse(f.file,f.instanceConfig)}}function r(){i.splice(0,1),n()}}),ie&&(_.onmessage=function(e){e=e.data,o.WORKER_ID===void 0&&e&&(o.WORKER_ID=e.workerId),typeof e.input=="string"?_.postMessage({workerId:o.WORKER_ID,results:o.parse(e.input,e.config),finished:!0}):(_.File&&e.input instanceof File||e.input instanceof Object)&&(e=o.parse(e.input,e.config))&&_.postMessage({workerId:o.WORKER_ID,results:e,finished:!0})}),(H.prototype=Object.create(W.prototype)).constructor=H,(P.prototype=Object.create(W.prototype)).constructor=P,(J.prototype=Object.create(J.prototype)).constructor=J,(ce.prototype=Object.create(W.prototype)).constructor=ce,o})})(be);var Te=be.exports,Ie=xe(Te);let j=0,X=[],ue=[];const Ae=25e3;let q=null,B=null,le=null,pe=!1;const $e=[/^lon$/i,/^lng$/i,/^long$/i,/^longitude$/i,/^x$/i,/^xcoord$/i,/^x_coord$/i,/^x-coord$/i,/^easting$/i,/^east$/i,/lon/i,/lng/i,/long/i,/^coord.*x/i,/x.*coord/i],De=[/^lat$/i,/^latitude$/i,/^y$/i,/^ycoord$/i,/^y_coord$/i,/^y-coord$/i,/^northing$/i,/^north$/i,/lat/i,/^coord.*y/i,/y.*coord/i],Le=[/^activitygroupid$/i,/^activity_group_id$/i,/^activitygroup$/i,/^groupid$/i,/^group_id$/i,/^group$/i,/^category$/i,/^class$/i,/^type$/i,/^zone$/i,/^region$/i,/^area$/i,/^district$/i,/^sector$/i,/^cluster$/i];function ge(S,y){for(const K of y)for(const _ of S)if(K.test(_))return _;return null}function Fe(S){const y=Object.keys(S);q=ge(y,$e),B=ge(y,De);const K=y.filter(_=>_!==q&&_!==B);le=ge(K,Le),pe=!0,console.log("[CSV Worker] Detected columns:",{longitude:q,latitude:B,group:le})}function _e(S,y){if(y&&S[y]!==void 0)return S[y]}function ve(S){if(S==null||S==="")return null;let y=String(S).trim();y=y.replace(/\s/g,"");const K=y.includes(","),_=y.includes(".");if(K&&_){const O=y.lastIndexOf(","),ie=y.lastIndexOf(".");O>ie?y=y.replace(/\./g,"").replace(",","."):y=y.replace(/,/g,"")}else if(K&&!_){const O=y.split(",");O.length===2&&O[1].length<=3?y=y.replace(",","."):y=y.replace(/,/g,"")}const ee=Number(y);return Number.isFinite(ee)?ee:null}self.onmessage=async S=>{const{type:y,file:K}=S.data;y==="parse"&&(j=0,X=[],ue=[],q=null,B=null,le=null,pe=!1,Ie.parse(K,{header:!0,dynamicTyping:!1,skipEmptyLines:!0,worker:!1,chunk:(_,ee)=>{_.data.forEach(O=>{if(!pe&&(Fe(O),!q||!B)){const H=Object.keys(O).join(", ");ue.push(`Could not detect coordinate columns. Available columns: ${H}. Please ensure your CSV has columns for longitude (e.g., lon, lng, longitude, x) and latitude (e.g., lat, latitude, y).`)}if(!q||!B){j++;return}const ie=_e(O,q),se=_e(O,B);_e(O,le);const G=ve(ie),o=ve(se);if(G===null||o===null){j<10&&ue.push(`Row ${j+1}: Invalid coordinates (${q}="${ie}", ${B}="${se}")`),j++;return}if(G<-180||G>180||o<-90||o>90){if(o>=-180&&o<=180&&G>=-90&&G<=90){const H={id:`point-${j}`,longitude:o,latitude:G,...Object.keys(O).reduce((P,J)=>(J!==q&&J!==B&&(P[J]=O[J]),P),{})};X.push(H)}else j<10&&ue.push(`Row ${j+1}: Coordinates out of range (lon=${G}, lat=${o})`);j++;return}const W={id:`point-${j}`,longitude:G,latitude:o,...Object.keys(O).reduce((H,P)=>(P!==q&&P!==B&&(H[P]=O[P]),H),{})};X.push(W),j++,X.length>=Ae&&(self.postMessage({type:"chunk",points:X,rowsProcessed:j}),X=[]),j%1e4===0&&self.postMessage({type:"progress",rowsProcessed:j,points:[]})})},complete:()=>{X.length>0&&(self.postMessage({type:"chunk",points:X,rowsProcessed:j}),X=[]),self.postMessage({type:"complete",points:[],errors:ue,detectedColumns:{longitude:q,latitude:B,group:le}})},error:_=>{self.postMessage({type:"error",message:`CSV parsing error: ${_.message}`})}}))}})();
